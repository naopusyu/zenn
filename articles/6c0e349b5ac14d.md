---
title: "PHPUnitã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å‹•ãé †ç•ªã‚’èª¿ã¹ãŸï¼ˆPHPUnit 13å¯¾å¿œï¼‰"
emoji: "ğŸŒ¿"
type: "tech"
topics:
  - "php"
  - "phpunit"
published: true
published_at: "2026-02-25 08:00"
---

## ã¯ã˜ã‚ã«

ä»¥å‰æ›¸ã„ãŸè¨˜äº‹ãŒPHPUnit 10å¯¾å¿œã—ãŸå†…å®¹ã ã£ãŸã®ã§ä»Šå›ã¯PHPUnit 13ã«å¯¾å¿œã—ãŸå½¢ã§æ›¸ãç›´ã—ã¾ã—ãŸã€‚

https://zenn.dev/naopusyu/articles/42d393c1c1b4bc

## ç’°å¢ƒ

- PHP 8.5.3
- PHPUnit 13.0.5

## èª¿ã¹ã‚‹å¯¾è±¡ã¨ç¢ºèªç”¨ã‚³ãƒ¼ãƒ‰

é•ã„ã‚’å‡ºã™å¿…è¦ã‚‚ãªã„ã®ã§ä»¥å‰ã¨åŒã˜ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å¯¾è±¡ã«ã—ã¾ã™ã€‚

- setUp
- tearDown
- setUpBeforeClass
- tearDownAfterClass
- assertPreConditions
- assertPostConditions
- onNotSuccessfulTest
- DataProvider

ã¾ãŸã€ç¢ºèªç”¨ã‚³ãƒ¼ãƒ‰ã‚‚ä¸€ç·’ã§ã™ã€‚ï¼ˆPHPUnit 10 â†’ 13ã§å¤‰æ›´ã™ã‚‹ç®‡æ‰€ã¯ãªã‹ã£ãŸã§ã™ã€‚ï¼‰

:::details è¼‰ã›ã¦ãŠãã¾ã™ãŒä¸€ç·’ãªã®ã§é–‰ã˜ã¦ã„ã¾ã™ã€‚
```php
<?php

declare(strict_types=1);

namespace Tests;

use PHPUnit\Framework\Attributes\DataProvider;
use PHPUnit\Framework\TestCase;
use Throwable;

class LifecycleTest extends TestCase
{
    public static function setUpBeforeClass(): void
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
    }

    public static function tearDownAfterClass(): void
    {
        fwrite(STDOUT, PHP_EOL . __METHOD__ . PHP_EOL);
    }

    protected function setUp(): void
    {
        fwrite(STDOUT, PHP_EOL . __METHOD__ . PHP_EOL);
    }

    protected function tearDown(): void
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
    }

    protected function assertPreConditions(): void
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
    }

    protected function assertPostConditions(): void
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
    }

    protected function onNotSuccessfulTest(Throwable $t): never
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
        throw $t;
    }

    public static function dataProvider(): array
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
        return [
            [1],
            [2],
            [3],
        ];
    }

    public function testMethod1(): void
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
        $this->assertTrue(true);
    }

    public function testMethod2(): void
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
        $this->assertTrue(false);
    }

    #[DataProvider('dataProvider')]
    public function testMethod3(int $a): void
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
        $this->assertTrue(true);
    }
}
```
:::

## çµæœ

çµæœã‚‚ä»¥å‰ã¨åŒã˜ã§ã—ãŸã€‚

:::details è¼‰ã›ã¦ãŠãã¾ã™ãŒä¸€ç·’ãªã®ã§é–‰ã˜ã¦ã„ã¾ã™ã€‚
```bash
% ./vendor/bin/phpunit tests/LifecycleTest.php
Tests\LifecycleTest::dataProvider
PHPUnit 13.0.5 by Sebastian Bergmann and contributors.

Runtime:       PHP 8.5.3

Tests\LifecycleTest::setUpBeforeClass

Tests\LifecycleTest::setUp
Tests\LifecycleTest::assertPreConditions
Tests\LifecycleTest::testMethod1
Tests\LifecycleTest::assertPostConditions
Tests\LifecycleTest::tearDown
.
Tests\LifecycleTest::setUp
Tests\LifecycleTest::assertPreConditions
Tests\LifecycleTest::testMethod2
Tests\LifecycleTest::tearDown
Tests\LifecycleTest::onNotSuccessfulTest
F
Tests\LifecycleTest::setUp
Tests\LifecycleTest::assertPreConditions
Tests\LifecycleTest::testMethod3
Tests\LifecycleTest::assertPostConditions
Tests\LifecycleTest::tearDown
.
Tests\LifecycleTest::setUp
Tests\LifecycleTest::assertPreConditions
Tests\LifecycleTest::testMethod3
Tests\LifecycleTest::assertPostConditions
Tests\LifecycleTest::tearDown
.
Tests\LifecycleTest::setUp
Tests\LifecycleTest::assertPreConditions
Tests\LifecycleTest::testMethod3
Tests\LifecycleTest::assertPostConditions
Tests\LifecycleTest::tearDown
.                                                               5 / 5 (100%)
Tests\LifecycleTest::tearDownAfterClass


Time: 00:00.003, Memory: 14.00 MB

There was 1 failure:

1) Tests\LifecycleTest::testMethod2
Failed asserting that false is true.

/phpunit-lifecycle/phpunit13/tests/LifecycleTest.php:68

FAILURES!
Tests: 5, Assertions: 5, Failures: 1.    
```
:::


1. DataProvider
    - æœ€åˆã«1å›ã ã‘å‹•ã
1. setUpBeforeClass  
    - æœ€åˆã«1å›ã ã‘å‹•ã  
1. setUp  
    - å„ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè¡Œå‰ã«å‹•ã
1. assertPreConditions  
    - å„ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè¡Œå‰ã«å‹•ã
1. ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰
1. assertPostConditions  
    - å„ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè¡Œå¾Œã«å‹•ãï¼ˆãŸã ã—ã€ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã—ãŸå ´åˆã®ã¿å‹•ãï¼‰
1. tearDown  
    - å„ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè¡Œå¾Œã«å‹•ã
1. onNotSuccessfulTest  
    - å„ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè¡Œå¾Œã«å‹•ãï¼ˆãŸã ã—ã€ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ãŸå ´åˆã®ã¿å‹•ãï¼‰
1. tearDownAfterClass  
    - æœ€å¾Œã«1å›ã ã‘å‹•ã

## ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã‚’å«ã‚ãŸçŠ¶æ…‹ã§å‹•ãé †ç•ªã‚‚èª¿ã¹ã¦ã¿ã‚‹

ä»¥å‰ã¨åŒã˜çµæœã§ã¯æ›¸ãç›´ã™æ„å‘³ã‚‚è–„ã‚Œã‚‹ã®ã§ä»Šå›ã¯ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã‚’å«ã‚ãŸçŠ¶æ…‹ã§å‹•ãé †ç•ªã‚‚èª¿ã¹ã¦ã¿ã¾ã™ã€‚
ãªãŠã€PHPUnitã®ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã¯PHPUnit 10ä»¥é™ã«å°å…¥ã•ã‚ŒãŸä»•çµ„ã¿ã§ã™ã€‚

https://docs.phpunit.de/en/13.0/events.html

ä¸Šè¨˜ã®URLã«æ›¸ã‹ã‚Œã¦ã„ã‚‹å…¨ã¦ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒã©ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å‹•ãã®ã‹1ã¤1ã¤èª¿ã¹ã‚‹ã«ã¯å¤šã™ãã‚‹ã®ã§ä»Šå›ã¯å®Ÿè¡Œæ™‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã« **--log-events-text** ã‚’ä»˜ã‘ã¦èª¿ã¹ã¦ã¿ã¾ã™ã€‚

```bash
% ./vendor/bin/phpunit tests/LifecycleTest.php --log-events-text lifecycle.log

// å®Ÿè¡ŒçµæœãŒè¡¨ç¤ºã—ã¦ã„ã‚‹

```

lifecycle.logãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã—ã¦ã„ã‚‹ã®ã§ãã¡ã‚‰ã‚’è¡¨ç¤ºã—ã¦ç¢ºèªã—ã¾ã™ã€‚

:::details ã¡ã‚‡ã£ã¨é•·ã„ã®ã§é–‰ã˜ã¦ãŠãã¾ã™ã€‚
```bash
% cat ./lifecycle.log
PHPUnit Started (PHPUnit 13.0.5 using PHP 8.5.3 (cli) on Darwin)
Test Runner Configured
Event Facade Sealed
Data Provider Method Called (Tests\LifecycleTest::dataProvider for test method Tests\LifecycleTest::testMethod3)
Data Provider Method Finished for Tests\LifecycleTest::testMethod3:
- Tests\LifecycleTest::dataProvider
Test Suite Loaded (5 tests)
Test Runner Started
Test Suite Sorted
Test Runner Execution Started (5 tests)
Test Suite Started (Tests\LifecycleTest, 5 tests)
Before First Test Method Called (Tests\LifecycleTest::setUpBeforeClass)
Before First Test Method Finished:
- Tests\LifecycleTest::setUpBeforeClass
Test Preparation Started (Tests\LifecycleTest::testMethod1)
Before Test Method Called (Tests\LifecycleTest::setUp)
Before Test Method Finished:
- Tests\LifecycleTest::setUp
Pre Condition Method Called (Tests\LifecycleTest::assertPreConditions)
Pre Condition Method Finished:
- Tests\LifecycleTest::assertPreConditions
Test Prepared (Tests\LifecycleTest::testMethod1)
Post Condition Method Called (Tests\LifecycleTest::assertPostConditions)
Post Condition Method Finished:
- Tests\LifecycleTest::assertPostConditions
After Test Method Called (Tests\LifecycleTest::tearDown)
After Test Method Finished:
- Tests\LifecycleTest::tearDown
Test Passed (Tests\LifecycleTest::testMethod1)
Test Finished (Tests\LifecycleTest::testMethod1)
Test Preparation Started (Tests\LifecycleTest::testMethod2)
Before Test Method Called (Tests\LifecycleTest::setUp)
Before Test Method Finished:
- Tests\LifecycleTest::setUp
Pre Condition Method Called (Tests\LifecycleTest::assertPreConditions)
Pre Condition Method Finished:
- Tests\LifecycleTest::assertPreConditions
Test Prepared (Tests\LifecycleTest::testMethod2)
Test Failed (Tests\LifecycleTest::testMethod2)
Failed asserting that false is true.
After Test Method Called (Tests\LifecycleTest::tearDown)
After Test Method Finished:
- Tests\LifecycleTest::tearDown
Test Finished (Tests\LifecycleTest::testMethod2)
Test Suite Started (Tests\LifecycleTest::testMethod3, 3 tests)
Test Preparation Started (Tests\LifecycleTest::testMethod3#0)
Before Test Method Called (Tests\LifecycleTest::setUp)
Before Test Method Finished:
- Tests\LifecycleTest::setUp
Pre Condition Method Called (Tests\LifecycleTest::assertPreConditions)
Pre Condition Method Finished:
- Tests\LifecycleTest::assertPreConditions
Test Prepared (Tests\LifecycleTest::testMethod3#0)
Post Condition Method Called (Tests\LifecycleTest::assertPostConditions)
Post Condition Method Finished:
- Tests\LifecycleTest::assertPostConditions
After Test Method Called (Tests\LifecycleTest::tearDown)
After Test Method Finished:
- Tests\LifecycleTest::tearDown
Test Passed (Tests\LifecycleTest::testMethod3#0)
Test Finished (Tests\LifecycleTest::testMethod3#0)
Test Preparation Started (Tests\LifecycleTest::testMethod3#1)
Before Test Method Called (Tests\LifecycleTest::setUp)
Before Test Method Finished:
- Tests\LifecycleTest::setUp
Pre Condition Method Called (Tests\LifecycleTest::assertPreConditions)
Pre Condition Method Finished:
- Tests\LifecycleTest::assertPreConditions
Test Prepared (Tests\LifecycleTest::testMethod3#1)
Post Condition Method Called (Tests\LifecycleTest::assertPostConditions)
Post Condition Method Finished:
- Tests\LifecycleTest::assertPostConditions
After Test Method Called (Tests\LifecycleTest::tearDown)
After Test Method Finished:
- Tests\LifecycleTest::tearDown
Test Passed (Tests\LifecycleTest::testMethod3#1)
Test Finished (Tests\LifecycleTest::testMethod3#1)
Test Preparation Started (Tests\LifecycleTest::testMethod3#2)
Before Test Method Called (Tests\LifecycleTest::setUp)
Before Test Method Finished:
- Tests\LifecycleTest::setUp
Pre Condition Method Called (Tests\LifecycleTest::assertPreConditions)
Pre Condition Method Finished:
- Tests\LifecycleTest::assertPreConditions
Test Prepared (Tests\LifecycleTest::testMethod3#2)
Post Condition Method Called (Tests\LifecycleTest::assertPostConditions)
Post Condition Method Finished:
- Tests\LifecycleTest::assertPostConditions
After Test Method Called (Tests\LifecycleTest::tearDown)
After Test Method Finished:
- Tests\LifecycleTest::tearDown
Test Passed (Tests\LifecycleTest::testMethod3#2)
Test Finished (Tests\LifecycleTest::testMethod3#2)
Test Suite Finished (Tests\LifecycleTest::testMethod3, 3 tests)
After Last Test Method Called (Tests\LifecycleTest::tearDownAfterClass)
After Last Test Method Finished:
- Tests\LifecycleTest::tearDownAfterClass
Test Suite Finished (Tests\LifecycleTest, 5 tests)
Test Runner Execution Finished
Test Runner Finished
PHPUnit Finished (Shell Exit Code: 1)
```
:::

å¤§é›‘æŠŠã«æ›¸ãã¨ã‚¤ãƒ™ãƒ³ãƒˆã¯æ¬¡ã®ã‚ˆã†ã«å‹•ãã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸã€‚
â€» æ‹¬å¼§å†…ã¯èª¿ã¹ã‚‹å¯¾è±¡ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒå‹•ã„ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã™ã€‚

1. PHPUnitã®é–‹å§‹
1. è¨­å®šï¼ˆphpunit.xmlï¼‰ã®èª­ã¿è¾¼ã¿
1. ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã®åˆæœŸåŒ–
1. ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®èª­ã¿è¾¼ã¿ï¼ˆDataProviderï¼‰
1. ãƒ†ã‚¹ãƒˆã®é–‹å§‹
1. ãƒ†ã‚¹ãƒˆã®å‰å‡¦ç†ï¼ˆsetUpBeforeClassï¼‰
1. ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®å‰å‡¦ç†ï¼ˆsetUp,assertPreConditionsï¼‰
1. ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè¡Œ
1. ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®çµæœ
1. ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®å¾Œå‡¦ç†ï¼ˆassertPostConditions,tearDownï¼‰
1. ãƒ†ã‚¹ãƒˆã®å¾Œå‡¦ç†ï¼ˆtearDownAfterClassï¼‰
1. ãƒ†ã‚¹ãƒˆã®çµ‚äº†

## ã¾ã¨ã‚

PHPUnitã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä¸ŠãŒã£ã¦ã‚‚ãƒ¡ã‚½ãƒƒãƒ‰ã®å‹•ãé †ç•ªã«å¤‰åŒ–ã¯ãªã‹ã£ãŸã§ã™ã€‚

ã¾ãŸã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã‚’å«ã‚ãŸçŠ¶æ…‹ã§å‹•ãé †ç•ªã‚‚èª¿ã¹ãŸã“ã¨ã§ã€
ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ãŒå‹•ãã¾ã§ã®æµã‚ŒãŒã‚ˆã‚Šè©³ç´°ã¨ãªã‚Šã¾ã—ãŸã€‚

ä»Šå›ç¢ºèªã—ãªã‹ã£ãŸä»–ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’å«ã‚ã‚‹ã“ã¨ã§ã•ã‚‰ã«æµã‚ŒãŒæ•´ç†ã§ããã†ãªã®ã§ã€
ãã‚Œã¯åˆ¥ã®æ©Ÿä¼šã«èª¿ã¹ã‚‹äºˆå®šã§ã™ã€‚
