---
title: "Laravel9ã§Seederã«Namespaceã‚’ä»˜ã‘ãªã„ã§å‹•ãã‹æ¤œè¨¼ã—ã¦ã¿ãŸ"
emoji: "ğŸŒ¿"
type: "tech"
topics:
  - "laravel"
  - "php"
published: true
published_at: "2022-02-17 00:24"
---

Laravelã‚’9.xã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹éç¨‹ã§8.xã®å¤‰æ›´ç‚¹ã‚’è¦‹ã¦ã„ãŸã‚‰ã€
ãã®ä¸­ã«Seederã«Namespaceã‚’ä»˜ã‘ã‚‹[^1]å¤‰æ›´ç‚¹ãŒã‚ã‚Šã¾ã—ãŸã€‚

ãŸã ã€SeederãŸãã•ã‚“ã‚ã‚‹ã‹ã‚‰ä»˜ã‘ãªã„ã§å‹•ããªã‚‰ä»˜ã‘ãŸããªã„ï¼ã£ã¦æ€ã£ãŸã®ã§ã€ä»˜ã‘ãªã„ã§å‹•ãã‹æ¤œè¨¼ã—ã¦ã¿ã¾ã—ãŸã€‚

[^1]: https://laravel.com/docs/8.x/upgrade#seeder-factory-namespaces

## ç’°å¢ƒ
- PHP v8.1.2
- Laravel v9.1.0

ç’°å¢ƒã¯**Laravel Sail**[^2]ã§ä½œã£ã¦ã„ã¾ã™ã€‚
[^2]: https://laravel.com/docs/9.x/sail

## æ¤œè¨¼

Laravel7.xã‚ãŸã‚Šã§ä½œæˆã—ãŸSeederã‚’æŒã£ã¦ãã¦ã€Laravel9.xç’°å¢ƒã§å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

:::details database/seeds/UserSeeder.php
```php:database/seeds/UserSeeder.php
<?php

use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Hash;
use Illuminate\Support\Str;

class UserSeeder extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        DB::table('users')->insert([
            'name' => Str::random(10),
            'email' => Str::random(10).'@gmail.com',
            'password' => Hash::make('password'),
        ]);
    }
}
```
:::

æŒã£ã¦ããŸã‚‰ã€Artisanã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ã¦å®Ÿè¡Œã—ã¾ã™ã€‚

```bash
$ ./vendor/bin/sail artisan db:seed --class=UserSeeder

   Illuminate\Contracts\Container\BindingResolutionException 

  Target class [Database\Seeders\UserSeeder] does not exist.

  at vendor/laravel/framework/src/Illuminate/Container/Container.php:879
    875â–• 
    876â–•         try {
    877â–•             $reflector = new ReflectionClass($concrete);
    878â–•         } catch (ReflectionException $e) {
  âœ 879â–•             throw new BindingResolutionException("Target class [$concrete] does not exist.", 0, $e);
    880â–•         }
    881â–• 
    882â–•         // If the type is not instantiable, the developer is attempting to resolve
    883â–•         // an abstract type such as an Interface or Abstract Class and there is

      +23 vendor frames 
  24  artisan:37
      Illuminate\Foundation\Console\Kernel::handle()
```

ã¯ã„ã€å¤±æ•—ã—ã¾ã—ãŸãƒ¼

## ãªãœã€å¤±æ•—ã—ãŸã®ã‹

å®Ÿè¡Œã—ãŸArtisanã‚³ãƒãƒ³ãƒ‰ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€

https://github.com/laravel/framework/blob/v9.1.0/src/Illuminate/Database/Console/Seeds/SeedCommand.php#L92-L108

å¼·åˆ¶çš„ã«Namespaceã‚’ä»˜ã‘ã¦ã„ã¾ã™ã­ã€œ

## çµè«–

**ä»˜ã‘ãªã„ã¨ãƒ€ãƒ¡ã§ã™ï¼ï¼**

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚‚`database/seeds` -> `database/seeders`ã«ãƒªãƒãƒ¼ãƒ ã—ãªã•ã„ã¨æ›¸ã„ã¦ã‚ã‚‹æ™‚ç‚¹ã§å¯Ÿã—ã¦ã„ã¾ã—ãŸãŒã€ãƒ€ãƒ¡ã§ã—ãŸã­ã€‚

å¤§äººã—ããƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã®éš›ã«ä»˜ã‘ãŸæ–¹ãŒè‰¯ã•ãã†ã§ã™ã€‚

## ã¡ãªã¿ã«...

Laravel8.xä»¥å‰ã‹ã‚‰åˆ¥ã®Namespaceã‚’ä»˜ã„ã¦ã„ã‚‹å ´åˆã¯ã€å®Ÿè¡Œå¯èƒ½ã§ã—ãŸã€‚

æ¤œè¨¼ã®ãŸã‚ã«å…ˆã»ã©ã®ã‚³ãƒ¼ãƒ‰ã«Namespaceã‚’è¿½åŠ ã—ã¦å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

:::details database/seeds/UserSeeder.php
```php:database/seeds/UserSeeder.php
<?php

namespace Database\Seeds;

use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Hash;
use Illuminate\Support\Str;

class UserSeeder extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        DB::table('users')->insert([
            'name' => Str::random(10),
            'email' => Str::random(10).'@gmail.com',
            'password' => Hash::make('password'),
        ]);
    }
}
```
:::

å°šã€å®Ÿè¡Œã™ã‚‹éš›ã¯Namespaceä»˜ãã§ã‚¯ãƒ©ã‚¹ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```bash
$ ./vendor/bin/sail artisan db:seed --class=Database\\Seeds\\UserSeeder
Database seeding completed successfully.
```

æˆåŠŸã§ã™ã­ãƒ¼

## çµè«–2

å¼·åˆ¶çš„ã«Namespaceã‚’ä»˜ã‘ã¦ã„ã‚‹å‡¦ç†ã‚’ã¿ã‚‹ã¨ã‚ã‹ã‚Šã¾ã™ãŒã€`\\`ã®æœ‰ç„¡ã§åˆ¤å®šã—ã¦ã„ã‚‹ã®ã§ã€
Laravel8.xã«ä¸Šã’ã‚‹å‰ã‹ã‚‰Seederã‚’Namespaceä»˜ãã§ä½œæˆã—ã¦ã„ã‚‹ãªã‚‰ã€ä»Šå›ã®å¤‰æ›´ç‚¹ã®å½±éŸ¿ã¯ãªã„ã‚ˆã†ã«æ„Ÿã˜ã¯ã—ã¾ã™ã€‚

ãŸã ã€LaravelãŒç”¨æ„ã—ãŸNamespaceã¨ç•°ãªã‚‹çŠ¶æ…‹ã«ãªã‚‹ã®ã§ã€ä½•ã‹ã—ã‚‰å‹•ä½œã«å½±éŸ¿ãŒå‡ºã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚‹ã®ã§ã€åˆã‚ã›ã‚‹ã»ã†ãŒç„¡é›£ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ã€‚
ï¼ˆã©ã‚Œãã‚‰ã„ã®ä¿®æ­£ãŒç™ºç”Ÿã™ã‚‹ã‹ã¯è¦æ¨¡æ¬¡ç¬¬ã§ã™ã­ã€‚ï¼‰