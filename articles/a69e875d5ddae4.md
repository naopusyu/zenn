---
title: "Laravel11 testã‚³ãƒãƒ³ãƒ‰"
emoji: "ğŸ‰"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [
    "laravel",
    "php"
]
published: false
published_at: "2024-12-24 06:00"
---

ã“ã®è¨˜äº‹ã¯ [Laravel11ã«ã‚ã‚‹artisanã‚³ãƒãƒ³ãƒ‰ã‚’å…¨éƒ¨èª¿ã¹ã‚‹ Advent Calendar 2024](https://adventar.org/calendars/10674) 24æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚

ä»Šå›ã¯testã‚³ãƒãƒ³ãƒ‰ã«ã¤ã„ã¦èª¿ã¹ã¾ã—ãŸã€‚

ã“ã‚Œã‚‰ã¯laravel/frameworkã«ã¯å®šç¾©ã—ã¦ã„ã‚‹ã‚‚ã®ã§ã¯ãªãã€[nunomaduro/collision](https://github.com/nunomaduro/collision)ã®Laravelæ‹¡å¼µãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å®šç¾©ã—ã¦ã„ã‚‹ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚
laravel/laravelã®[composer.json](https://github.com/laravel/laravel/blob/v11.3.3/composer.json)ã«æ›¸ã‹ã‚Œã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã ã£ãŸã®ã§å¯¾è±¡ã«å«ã‚ã¦ã„ã¾ã™ã€‚

## ç’°å¢ƒ

- PHP 8.4.1
- laravel/laravel 11.3.3
- laravel/framework 11.33.2

## test

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã€‚

```
php artisan test
```

å®Ÿè¡Œã™ã‚‹ã¨PHPUnitã‚‚ã—ãã¯Pestã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```
advent-calendar-2024 % php artisan test

   PASS  Tests\Unit\ExampleTest
  âœ“ that true is true

   PASS  Tests\Feature\ExampleTest
  âœ“ the application returns a successful response    0.04s

  Tests:    2 passed (2 assertions)
  Duration: 0.07s
```

ã¾ãŸã€PHPUnitã‚‚ã—ãã¯Pestã«æ¸¡ã™ã“ã¨ãŒã§ãã‚‹å¼•æ•°ã¯testã‚³ãƒãƒ³ãƒ‰ã§ã‚‚æ¸¡ã™ã“ã¨ãŒã§ãã¾ã™ã€‚

```
advent-calendar-2024 % php artisan test --testsuite=Feature

   PASS  Tests\Feature\ExampleTest
  âœ“ the application returns a successful response    0.07s  

  Tests:    1 passed (1 assertions)
  Duration: 0.14s
```

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | èª¬æ˜ |
| --- | --- |
| `--without-tty` | TTYã¸ã®å‡ºåŠ›ã‚’ç„¡åŠ¹ |
| `--compact` | çµæœã‚’ç°¡æ½”ã«è¡¨ç¤º |
| `--coverage` | ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ã®è¨ˆæ¸¬ |
| `--min[=MIN]` | ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ã®æœ€å°ã—ãã„å€¤ã‚’æŒ‡å®š |
| `-p`<br>`--parallel` | ãƒ†ã‚¹ãƒˆã‚’ä¸¦åˆ—ã§å®Ÿè¡Œ |
| `--profile` | ã‚‚ã£ã¨ã‚‚é…ã„ãƒ†ã‚¹ãƒˆãƒˆãƒƒãƒ—10ã®ãƒªã‚¹ãƒˆè¡¨ç¤º |
| `--recreate-databases` | ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å†ä½œæˆ |
| `--drop-databases` | ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å‰Šé™¤ |
| `--without-databases` | ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãŒç„¡åŠ¹ |

- `--without-tty`ã‚’ä»˜ã‘ã‚‹ã¨TTYã¸ã®å‡ºåŠ›ã‚’ç„¡åŠ¹ã«ã§ãã¾ã™
- `--compact`ã‚’ä»˜ã‘ã‚‹ã¨ãƒ†ã‚¹ãƒˆçµæœã‚’ç°¡æ½”ã«è¡¨ç¤ºã—ã¾ã™
```
advent-calendar-2024 % php artisan test --compact

  ..

  Tests:    2 passed (2 assertions)
  Duration: 0.14s
```
- `--coverage`ã‚’ä»˜ã‘ã‚‹ã¨ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ã®è¨ˆæ¸¬ãŒå¯èƒ½ã§ã™
ã‚«ãƒãƒ¬ãƒƒã‚¸è¨ˆæ¸¬ã‚’è¡Œã†ã«ã¯åˆ¥é€”Xdebugã€ã¾ãŸã¯PCOVãŒå¿…è¦ã§ã™
- `--min`ã‚’ä½¿ã†ã“ã¨ã§ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã®æœ€å°å€¤ã‚’æŒ‡å®šã§ãã¾ã™
æŒ‡å®šã—ãŸå€¤ã«æº€ãŸãªã„ãƒ†ã‚¹ãƒˆã¯å¤±æ•—ã—ã¾ã™
- `-p`ã€ã‚‚ã—ãã¯`--parallel`ã‚’ä»˜ã‘ã‚‹ã¨ãƒ†ã‚¹ãƒˆã‚’ä¸¦åˆ—ã§å®Ÿè¡Œã§ãã¾ã™
ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ã†ã«ã¯[brianium/paratest](https://github.com/paratestphp/paratest)ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã§ã™
- `--profile`ã‚’ä»˜ã‘ã‚‹ã¨ã‚‚ã£ã¨ã‚‚é…ã„10ä»¶ã®ãƒ†ã‚¹ãƒˆã®ãƒªã‚¹ãƒˆãŒè¡¨ç¤ºã§ãã¾ã™
```
advent-calendar-2024 % php artisan test --profile

   PASS  Tests\Unit\ExampleTest
  âœ“ that true is true

   PASS  Tests\Feature\ExampleTest
  âœ“ the application returns a successful response    0.07s

  Tests:    2 passed (2 assertions)
  Duration: 0.14s

  Top 10 slowest tests:
  Tests\Feature\ExampleTest > the application return 0.07s
  Tests\Unit\ExampleTest > that true is true         0.00s
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                                   (54.31% of 0.14s) 0.08s
```
- `--recreate-databases`ã‚’ä»˜ã‘ã‚‹ã¨ä¸¦åˆ—ãƒ†ã‚¹ãƒˆã®é–‹å§‹æ™‚ã«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å†ä½œæˆã—ã¾ã™
- `--drop-databases`ã‚’ä»˜ã‘ã‚‹ã¨ä¸¦åˆ—ãƒ†ã‚¹ãƒˆã®çµ‚äº†æ™‚ã«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å‰Šé™¤ã—ã¾ã™
- `--without-databases`ã‚’ä»˜ã‘ã‚‹ã¨ä¸¦åˆ—ãƒ†ã‚¹ãƒˆä¸­ã«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šã‚’ç„¡åŠ¹åŒ–ã—ã¾ã™
