---
title: "PHPUnitã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å‹•ãé †ç•ªã‚’èª¿ã¹ãŸ"
emoji: "ğŸŒ¿"
type: "tech"
topics:
  - "php"
  - "phpunit"
published: true
published_at: "2022-11-19 22:40"
---

## ã¯ã˜ã‚ã«
ä»¥å‰ã€PHPUnitã®`setUp`ã‚„`tearDown`ãªã©ãŒã©ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å‹•ãã®ã‹èª¿ã¹ã¦ã„ãŸã®ã§ã€  
çµæœã‚’æ›¸ã„ã¦ãŠã“ã†ã¨æ€ã„ã¾ã™ã€‚

## ç’°å¢ƒ

- PHP 8.2.3
- PHPUnit 10.0.13

## èª¿ã¹ã‚‹å¯¾è±¡ã®ãƒ¡ã‚½ãƒƒãƒ‰

- setUp
- tearDown
- setUpBeforeClass
- tearDownAfterClass
- assertPreConditions
- assertPostConditions
- onNotSuccessfulTest
- ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ãƒã‚¤ãƒ€

## ç¢ºèªç”¨ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰

```php
<?php

declare(strict_types=1);

namespace Tests;

use PHPUnit\Framework\Attributes\DataProvider;
use PHPUnit\Framework\TestCase;
use Throwable;

class LifecycleTest extends TestCase
{
    public static function setUpBeforeClass(): void
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
    }

    public static function tearDownAfterClass(): void
    {
        fwrite(STDOUT, PHP_EOL . __METHOD__ . PHP_EOL);
    }

    protected function setUp(): void
    {
        fwrite(STDOUT, PHP_EOL . __METHOD__ . PHP_EOL);
    }

    protected function tearDown(): void
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
    }

    protected function assertPreConditions(): void
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
    }

    protected function assertPostConditions(): void
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
    }

    protected function onNotSuccessfulTest(Throwable $t): never
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
        throw $t;
    }

    public static function dataProvider(): array
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
        return [
            [1],
            [2],
            [3],
        ];
    }

    public function testMethod1(): void
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
        $this->assertTrue(true);
    }

    public function testMethod2(): void
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
        $this->assertTrue(false);
    }

    #[DataProvider('dataProvider')]
    public function testMethod3(int $a): void
    {
        fwrite(STDOUT, __METHOD__ . PHP_EOL);
        $this->assertTrue(true);
    }
}

```

## çµæœ

```bash
$ vendor/bin/phpunit tests/LifecycleTest.php 
Tests\LifecycleTest::dataProvider
PHPUnit 10.0.13 by Sebastian Bergmann and contributors.

Runtime:       PHP 8.2.3
Configuration: /var/www/html/phpunit.xml

Tests\LifecycleTest::setUpBeforeClass

Tests\LifecycleTest::setUp
Tests\LifecycleTest::assertPreConditions
Tests\LifecycleTest::testMethod1
Tests\LifecycleTest::assertPostConditions
Tests\LifecycleTest::tearDown
.
Tests\LifecycleTest::setUp
Tests\LifecycleTest::assertPreConditions
Tests\LifecycleTest::testMethod2
Tests\LifecycleTest::tearDown
Tests\LifecycleTest::onNotSuccessfulTest
F
Tests\LifecycleTest::setUp
Tests\LifecycleTest::assertPreConditions
Tests\LifecycleTest::testMethod3
Tests\LifecycleTest::assertPostConditions
Tests\LifecycleTest::tearDown
.
Tests\LifecycleTest::setUp
Tests\LifecycleTest::assertPreConditions
Tests\LifecycleTest::testMethod3
Tests\LifecycleTest::assertPostConditions
Tests\LifecycleTest::tearDown
.
Tests\LifecycleTest::setUp
Tests\LifecycleTest::assertPreConditions
Tests\LifecycleTest::testMethod3
Tests\LifecycleTest::assertPostConditions
Tests\LifecycleTest::tearDown
.                                                               5 / 5 (100%)
Tests\LifecycleTest::tearDownAfterClass


Time: 00:00.025, Memory: 10.00 MB

There was 1 failure:

1) Tests\LifecycleTest::testMethod2
Failed asserting that false is true.

/var/www/html/tests/LifecycleTest.php:68

FAILURES!
Tests: 5, Assertions: 5, Failures: 1.

```

## ã¾ã¨ã‚

æ¬¡ã®ã‚ˆã†ãªçµæœã«ãªã‚Šã¾ã—ãŸã€‚

1. ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ãƒã‚¤ãƒ€  
ãƒ»æœ€åˆã«1å›ã ã‘å‹•ã
1. setUpBeforeClass  
ãƒ»æœ€åˆã«1å›ã ã‘å‹•ã  
1. setUp  
ãƒ»å„ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè¡Œå‰ã«å‹•ã
1. assertPreConditions  
ãƒ»å„ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè¡Œå‰ã«å‹•ã
1. ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰
1. assertPostConditions  
ãƒ»å„ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè¡Œå¾Œã«å‹•ã  
ãƒ»ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã—ãŸå ´åˆã®ã¿å‹•ã  
1. tearDown  
ãƒ»å„ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè¡Œå¾Œã«å‹•ã
1. onNotSuccessfulTest  
ãƒ»å„ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè¡Œå¾Œã«å‹•ã  
ãƒ»ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ãŸå ´åˆã®ã¿å‹•ã  
1. tearDownAfterClass  
ãƒ»æœ€å¾Œã«1å›ã ã‘å‹•ã

ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ãƒã‚¤ãƒ€ãŒ1ç•ªæœ€åˆã«å‹•ãã“ã¨ãŒåˆ¤æ˜
