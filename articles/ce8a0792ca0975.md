---
title: "PHP 8.5の array_first、array_last関数の追加から振り返る、配列の「最初と最後」取得術"
emoji: "🧣"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["php"]
published: false
---

## はじめに

PHP 8.5の新機能に`array_first`、`array_last`関数が追加されました。

https://www.php.net/releases/8.5/ja.php#array-first-and-last-functions

配列の最初と最後の値はこの2つの関数を使うことで取得できるようになりました。

では、PHP 8.5が出る前までは配列の最初と最後の値をどのように取得していたのでしょうか？？

この記事ではあえてPHP 8.4以前の取り方を考えます。

:::message
今回は関数を使った取り方に限定して考えます。
また、空配列を指定した時のことは考慮していないです。
:::

## 環境

- PHP 8.5.1

## まずは`array_first`、`array_last`関数の動きを確認する

せっかくなので`array_first`、`array_last`関数を使って配列の最初と最後の値を取得します。

https://www.php.net/manual/ja/function.array-first.php

https://www.php.net/manual/ja/function.array-last.php

```php
$array = [1 => 'a', 0 => 'b', 3 => 'c', 2 => 'd'];

echo '配列の最初の値 = ' . array_first($array) . PHP_EOL;
// 配列の最初の値 = a
echo '配列の最後の値 = ' . array_last($array) . PHP_EOL;
// 配列の最後の値 = d
```

## 配列の「最初の値」を取得する

では、`array_first`関数がなかった時代の最初の値を取得する方法をいくつか考えていきます。

### `reset`関数を使う

`reset`関数を使って、配列の最初の値を取得します。

https://www.php.net/manual/ja/function.reset.php

```php
$array = [1 => 'a', 0 => 'b', 3 => 'c', 2 => 'd'];

echo '配列の最初の値 = ' . reset($array) . PHP_EOL;
// 配列の最初の値 = a
```

### `array_key_first`関数を使う

PHP 7.3で追加された`array_key_first`関数を使えば配列の最初のキーが取得し、それを使って配列の最初の値を取得します。

https://www.php.net/manual/ja/function.array-key-first.php

```php
$array = [1 => 'a', 0 => 'b', 3 => 'c', 2 => 'd'];

echo '配列の最初の値 = ' . $array[array_key_first($array)] . PHP_EOL;
// 配列の最初の値 = a
```

### `array_shift`関数を使う

`array_shift`関数を使って、配列の最初の値を取得します。

https://www.php.net/manual/ja/function.array-shift.php

:::message alert
但し取得した後は配列から値が消えるので注意が必要です。
:::

```php
$array = [1 => 'a', 0 => 'b', 3 => 'c', 2 => 'd'];

echo '配列の最初の値 = ' . array_shift($array) . PHP_EOL;
// 配列の最初の値 = a

print_r($array);
// 先頭が消えて、数字のキーだと0から振り直される
// Array
// (
//     [0] => b
//     [1] => c
//     [2] => d
//)
```

## 配列の「最後の値」を取得する

次に`array_last()`関数を使わないで最後の値を取得する方法もいくつか考えていきます。

### `end`関数を使う

`end`関数を使って、配列の最後の値を取得します。

https://www.php.net/manual/ja/function.end.php

```php
$array = [1 => 'a', 0 => 'b', 3 => 'c', 2 => 'd'];

echo '配列の最後の値 = ' . end($array) . PHP_EOL;
// 配列の最後の値 = d
```

### `array_key_last`関数を使う

PHP 7.3で追加された`array_key_last`関数を使えば配列の最後のキーが取得し、それを使って配列の最後の値を取得します。

https://www.php.net/manual/ja/function.array-key-last.php

```php
$array = [1 => 'a', 0 => 'b', 3 => 'c', 2 => 'd'];

echo '配列の最後の値 = ' . $array[array_key_last($array)] . PHP_EOL;
// 配列の最後の値 = d
```

### `array_pop`関数を使う

`array_pop`関数を使って、配列の最後の値を取得します。

https://www.php.net/manual/ja/function.array-pop.php

:::message alert
但し取得した後は配列から値が消えるので注意が必要です。
:::

```php
$array = [1 => 'a', 0 => 'b', 3 => 'c', 2 => 'd'];

echo '配列の最後の値 = ' . array_shift($array) . PHP_EOL;
// 配列の最後の値 = d

print_r($array);
// 
// Array
// (
//     [1] => a
//     [0] => b
//     [3] => c
//)
```

## 配列の「最初と最後」のどちらにも取得する

ここまでは最初と最後で別々の関数を使いましたが次は1つの関数で最初と最後の値を取得する方法もいくつか考えていきます。

### `array_slice`関数を使う

`array_slice`関数を使うことで最初と最後のどちらも取得できます。

https://www.php.net/manual/ja/function.array-slice.php

```php
$array = [1 => 'a', 0 => 'b', 3 => 'c', 2 => 'd'];

// 配列の先頭から1つ取得し、その配列の0番目を取得する
echo '配列の最初の値 = ' . array_slice($array, 0, 1)[0] . PHP_EOL; 
// 配列の最初の値 = a

// 配列の最後から1つ取得し、その配列の0番目を取得する
echo '配列の最後の値 = ' . array_slice($array, -1, 1)[0] . PHP_EOL;
// 配列の最後の値 = d
```

### `array_values`関数を使う

`array_values`関数を使うことで最初と最後のどちらも取得できます。

https://www.php.net/manual/ja/function.array-values.php

:::message alert
大きい配列だとメモリ消費に注意が必要です。
:::

```php
$array = [1 => 'a', 0 => 'b', 3 => 'c', 2 => 'd'];

// 配列から全ての値を取得する
$values = array_values($array);

// キーが0から振り直されるので0番目を取得する
echo '配列の最初の値 = ' . $values[0] . PHP_EOL; 
// 配列の最初の値 = a

// 配列の件数 - 1で最後の値を取得する
echo '配列の最後の値 = ' . $values[count($values) - 1] . PHP_EOL;
// 配列の最後の値 = d
```

## まとめ

今回紹介したコードはごく一部ですが、配列の最初と最後の取得方法は色々ありました。
ほかにも取得する方法があると思うので考えてみるといいかもしれないですね。

また、今回は触れていないですがフレームワーク（Laravel、CakePHPなど）でも独自に同様の機能（Collectionクラス）は提供されているので合わせて確認するのもいいかもしれないです。
