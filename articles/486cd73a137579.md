---
title: "Laravel11 storageã‚³ãƒãƒ³ãƒ‰"
emoji: "ğŸŒ¿"
type: "tech"
topics:
  - "laravel"
  - "php"
published: true
published_at: "2024-12-23 06:00"
---

ã“ã®è¨˜äº‹ã¯ [Laravel11ã«ã‚ã‚‹artisanã‚³ãƒãƒ³ãƒ‰ã‚’å…¨éƒ¨èª¿ã¹ã‚‹ Advent Calendar 2024](https://adventar.org/calendars/10674) 23æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚

ä»Šå›ã¯storageã‚³ãƒãƒ³ãƒ‰ã«ã¤ã„ã¦èª¿ã¹ã¾ã—ãŸã€‚

## ç’°å¢ƒ

- PHP 8.4.1
- laravel/laravel 11.3.3
- laravel/framework 11.33.2

## storage:link

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã«è¨­å®šã—ãŸã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’ä½œæˆã™ã‚‹ã€‚

```
php artisan storage:link
```

å®Ÿè¡Œã™ã‚‹ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã«è¨­å®šã—ãŸã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’ä½œæˆã—ã¾ã™ã€‚

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯storage/app/publicã‹ã‚‰public/storageã¸ã®ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’ä½œæˆã—ã¾ã™ã€‚

```
advent-calendar-2024 % php artisan storage:link

   INFO  The [public/storage] link has been connected to [storage/app/public].
```

è¨­å®šã¯config/filesystems.phpã®æ¬¡ã®é…åˆ—ã«æ›¸ãã“ã¨ãŒã§ãã¾ã™ã€‚
é…åˆ—ã®å€¤ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ä½œæˆã™ã‚‹ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚‚å¢—ãˆã¾ã™ã€‚

```php:config/filesystems.php
'links' => [
    public_path('storage') => storage_path('app/public'),
    public_path('images') => storage_path('app/images'), // è¿½åŠ 
],
```

```
advent-calendar-2024 % php artisan storage:link

   INFO  The [public/storage] link has been connected to [storage/app/public].

   INFO  The [public/images] link has been connected to [storage/app/images].
```

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | èª¬æ˜ |
| --- | --- |
| `--relative` | ç›¸å¯¾ç›¸å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’ä½œæˆ |
| `--force` | æ—¢å­˜ã®ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’å†ä½œæˆ |

- `--relative`ã‚’ä»˜ã‘ã‚‹ã¨ç›¸å¯¾ãƒ‘ã‚¹ã§ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’ä½œæˆã—ã¾ã™
ãŸã ã—ã€ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ã†ã«ã¯[symfony/filesystem](https://github.com/symfony/filesystem)ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã§ã™
- `--force`ã‚’ä»˜ã‘ã‚‹ã¨ã™ã§ã«ä½œæˆæ¸ˆã¿ã®ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’ä¸€åº¦å‰Šé™¤ã—ã¦å†åº¦ä½œæˆã—ã¾ã™

## storage:unlink

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã«è¨­å®šã—ãŸä½œæˆæ¸ˆã¿ã®ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’å‰Šé™¤ã™ã‚‹ã€‚

```
php artisan storage:unlink
```

å®Ÿè¡Œã™ã‚‹ã¨ä½œæˆæ¸ˆã¿ã®ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

å‰Šé™¤ã®å¯¾è±¡ã¯config/filesystems.phpã®é…åˆ—ã«è¨­å®šã—ã¦ã„ã‚‹ã‚­ãƒ¼ã®éƒ¨åˆ†ã«ãªã‚Šã¾ã™ã€‚
ã¤ãã®å ´åˆã¯ã€public_path('storage')ã¨public_path('images')ãŒå‰Šé™¤å¯¾è±¡ã§ã™

```php:config/filesystems.php
'links' => [
    public_path('storage') => storage_path('app/public'),
    public_path('images') => storage_path('app/images'),
],
```

