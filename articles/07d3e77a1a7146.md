---
title: "Rectorã‚’ä½¿ã£ã¦è¿”ã™å‹ã«voidã‚’ä»˜ã‘ã‚‹"
emoji: "ğŸ«™"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [
  "php",
  "rector"
]
published: true
published_at: "2025-02-24 21:00"
---

## ã¯ã˜ã‚ã«

è¿”ã™å€¤ãŒãªã„æ™‚ã«voidã‚’æŒ‡å®šã™ã‚‹ãŒã€
æœªæŒ‡å®šã®ãƒ¡ã‚½ãƒƒãƒ‰ã«å¯¾ã—ã¦1ã¤1ã¤æ‰‹ä½œæ¥­ã§ã¤ã‘ã‚‹ã®ã¯ãŸã„ã¸ã‚“é¢å€’ãªã®ã§ä¸€æ‹¬ã§ã¤ã‘ã‚‹ãƒ«ãƒ¼ãƒ«ãŒRectorã«ã‚ã‚‹ã‹èª¿ã¹ãŸã‚‰...

ã‚ã£ãŸï¼ï¼ã€ã¾ã•ã‹ã®2ã¤ï¼ï¼

* AddVoidReturnTypeWhereNoReturnRector
* AddTestsVoidReturnTypeWhereNoReturnRector

ãã“ã§ã“ã®è¨˜äº‹ã§2ã¤ã‚’è©¦ã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ãŸã€‚

## ç’°å¢ƒ

- PHP 8.4.4

## ãƒ«ãƒ¼ãƒ«

ã¾ãšã¯2ã¤ã®ãƒ«ãƒ¼ãƒ«ã®é•ã„ã‚’èª¿ã¹ã‚‹ã€‚

- [AddVoidReturnTypeWhereNoReturnRector](https://github.com/rectorphp/rector/blob/main/docs/rector_rules_overview.md#addvoidreturntypewherenoreturnrector)
    - ãƒ¡ã‚½ãƒƒãƒ‰ã®è¿”ã™å‹ã«`void`ãŒä»˜ã„ã¦ã„ãªã„å ´åˆã«ä»˜ã‘ã‚‹ãƒ«ãƒ¼ãƒ«

- [AddTestsVoidReturnTypeWhereNoReturnRector](https://github.com/rectorphp/rector/blob/main/docs/rector_rules_overview.md#addtestsvoidreturntypewherenoreturnrector)
    - PHPUnitã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã«å®šç¾©ã—ã¦ã„ã‚‹ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®è¿”ã™å‹ã«`void`ãŒä»˜ã„ã¦ã„ãªã„å ´åˆã«ä»˜ã‘ã‚‹ãƒ«ãƒ¼ãƒ«

AddTestsVoidReturnTypeWhereNoReturnRectorã‚’ä½¿ã†ã®ã¯ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã¨ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ä»¥å¤–ã®ã‚¯ãƒ©ã‚¹ãŒåŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆtestsé…ä¸‹ï¼‰ã«å…±å­˜ã—ã¦ã„ã‚‹å ´åˆã«ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã®ã¿ã«å¯¾è±¡ã‚’çµã‚ŠãŸã„æ™‚ã«ä½¿ã†ã®ã‹ãªï¼Ÿ

ä»Šå›ã¯AddVoidReturnTypeWhereNoReturnRectorã‚’ä½¿ãˆã°voidã‚’ä»˜ã‘ã‚‹ç›®çš„ã¯é”æˆã§ãã‚‹ã‹ã‚‰ä½¿ã†ã®ã¯1ã¤ã§å•é¡Œã¯ãªã•ãã†ã€‚

## è©¦ã™

ä»¥é™ã¯å®Ÿéš›ã«Rectorã‚’ä½¿ã£ã¦ä¿®æ­£ã™ã‚‹ã¾ã§ã‚’è©¦ã—ã¦ã¿ã‚‹ã€‚

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

[README](https://github.com/rectorphp/rector?tab=readme-ov-file#install)ã«æ›¸ã‹ã‚Œã¦ã„ã‚‹æ‰‹é †ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```
composer require rector/rector --dev
```

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã«ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã—ã¦ã¿ã‚‹ã€‚

> vendor/bin/rector --version

```
% ./vendor/bin/rector --version
Rector 2.0.9
```

ã“ã®è¨˜äº‹ã‚’æ›¸ã„ã¦ã„ã‚‹æ™‚ç‚¹ã§ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯**2.0.9**ã§ã™ã€‚

### Rectorã®åˆæœŸåŒ–

ã¾ãšã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®`rector.php`ã‚’ä½œã‚‹ãŸã‚ã«`vendor/bin/rector`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚
å®Ÿè¡Œã™ã‚‹ã¨ã€`rector.php`ãŒãªã„ã¨è¨€ã‚ã‚Œã‚‹ã®ã§ã€**yes**ã¨å…¥åŠ›ã—ä½œæˆã™ã‚‹ã€‚

```
% ./vendor/bin/rector

 No "rector.php" config found. Should we generate it for you? [yes]:
 > yes


 [OK] The config is added now. Re-run command to make Rector do the work!

```

ä½œæˆã—ãŸ`rector.php`ã‚’ã¤ãã®ã‚ˆã†ã«æ›¸ãæ›ãˆã‚‹ã€‚

```php
<?php

declare(strict_types=1);

use Rector\Config\RectorConfig;
use Rector\TypeDeclaration\Rector\ClassMethod\AddVoidReturnTypeWhereNoReturnRector;

return RectorConfig::configure()
    ->withPaths([
        __DIR__ . '/src',
        __DIR__ . '/tests',
    ])
    ->withRules([
        AddVoidReturnTypeWhereNoReturnRector::class,
    ]);
```

### å®Ÿè¡Œ

é©å½“ã«ç”¨æ„ã—ãŸä¸‹è¨˜ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã«å¯¾ã—ã¦å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

```php:src/A.php
<?php

class A {
    public function test()
    {
        return;
    }
}
```

```php:tests/ATest.php
<?php

class ATest extends \PHPUnit\Framework\TestCase
{
    public function test()
    {
        $this->assertSame(1, 1);
    }
}
```

å®Ÿè¡Œã¯ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†ã€‚

> vendor/bin/rector process --dry-run

ã¾ãšã¯`--dry-run`ã‚’ä»˜ã‘ã‚‹ã“ã¨ã§ä¿®æ­£ã•ã‚Œã‚‹ã‹ç¢ºèªã—ã¦ã¿ã‚‹ã€‚
æ¤œæŸ»å¯¾è±¡ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯`rector.php`ã«æ›¸ã„ãŸã®ã§çœç•¥ã™ã‚‹ã€‚

```
% vendor/bin/rector process --dry-run
 2/2 [â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“] 100%
2 files with changes
====================

1) src/A.php:0

    ---------- begin diff ----------
@@ @@
 <?php

 class A {
-    public function test()
+    public function test(): void
     {
         return;
     }
    ----------- end diff -----------

Applied rules:
 * AddVoidReturnTypeWhereNoReturnRector


2) tests/ATest.php:1

    ---------- begin diff ----------
@@ @@

 class ATest extends \PHPUnit\Framework\TestCase
 {
-    public function test()
+    public function test(): void
     {
         $this->assertSame(1, 1);
     }
    ----------- end diff -----------

Applied rules:
 * AddVoidReturnTypeWhereNoReturnRector

 [OK] 2 files would have been changed (dry-run) by Rector

```

æƒ³å®šé€šã‚Šã®çµæœãªã‚‰`--dry-run`ãªã—ã§å®Ÿè¡Œã—ã€ä¿®æ­£ã‚’é©ç”¨ã™ã‚‹ã€‚

```
% vendor/bin/rector process
 2/2 [â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“] 100%
2 files with changes
====================

1) src/A.php:0

    ---------- begin diff ----------
@@ @@
 <?php

 class A {
-    public function test()
+    public function test(): void
     {
         return;
     }
    ----------- end diff -----------

Applied rules:
 * AddVoidReturnTypeWhereNoReturnRector


2) tests/ATest.php:1

    ---------- begin diff ----------
@@ @@

 class ATest extends \PHPUnit\Framework\TestCase
 {
-    public function test()
+    public function test(): void
     {
         $this->assertSame(1, 1);
     }
    ----------- end diff -----------

Applied rules:
 * AddVoidReturnTypeWhereNoReturnRector

 [OK] 2 files have been changed by Rector

```

ä¿®æ­£ãŒé©ç”¨ã•ã‚Œã¦ã„ã‚Œã°`vendor/bin/rector process`ã‚’å†åº¦å®Ÿè¡Œã™ã‚‹ã¨å¯¾è±¡ã¯ç„¡ã—ã«ãªã£ã¦ã„ã¾ã™ã€‚

```
% vendor/bin/rector process
 2/2 [â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“] 100%

 [OK] Rector is done!

```

ã“ã‚Œã§å¤§ä¸ˆå¤«ã§ã™ã€ä¿®æ­£æ¸ˆã¿ã€ãƒ¡ã‚½ãƒƒãƒ‰ã«`void`ãŒä»˜ã„ã¦ã„ã¾ã™ã­ã€‚

## ã¾ã¨ã‚

Rectorã‚’ä½¿ãˆã°1ã¤1ã¤æ‰‹ä½œæ¥­ã‚’è¡Œã†å¿…è¦ã‚‚ãªãä¸€æ‹¬ã§å¯¾å¿œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ä»Šå›ã¯`void`ã‚’ä»˜ã‘ã‚‹ã‚’è©¦ã—ã¾ã—ãŸãŒåˆ¥ã®ãƒ«ãƒ¼ãƒ«ã§ã¯PHPDocã®å†…å®¹ã‚’ã‚‚ã¨ã«å¼•æ•°ã®å‹ã‚„è¿”ã™å‹ã‚’è¨­å®šã‚‚ã§ãã‚‹ã®ã§æ´»ç”¨ã—ã¦ã¿ã‚‹ã‚‚ã®è‰¯ã„ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ã€‚

