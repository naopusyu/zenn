---
title: "Laravelã§å˜ä¸€ãƒ†ãƒ¼ãƒ–ãƒ«ç¶™æ‰¿ã®å®Ÿè£…ã‚’è©¦ã—ã¦ã¿ãŸ"
emoji: "ğŸ¥‡"
type: "tech"
topics:
  - "laravel"
  - "php"
published: true
published_at: "2023-12-02 07:21"
---

ã“ã®è¨˜äº‹ã¯ Laravel Advent Calendar 2023 2æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚
https://qiita.com/advent-calendar/2023/laravel

## ã¯ã˜ã‚ã«

åŒã˜ã‚ˆã†ãªæ§‹é€ ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ©Ÿèƒ½ã”ã¨ã«ä½œã£ã¦ã„ã‚‹ã¨1ã¤ã«ã§ããªã„ã‹ãªãƒ¼ã¨ã‹è€ƒãˆã¦ã„ãŸæ™‚ã«
å˜ä¸€ãƒ†ãƒ¼ãƒ–ãƒ«ç¶™æ‰¿ï¼ˆSTI = single table inheritanceï¼‰ã¨ã„ã†ä»•çµ„ã¿ãŒã‚ã‚‹ã“ã¨ã‚’çŸ¥ã‚Šã¾ã—ãŸã€‚

Ruby on Railsã§ã¯ã™ã§ã«ç”¨æ„ã•ã‚Œã¦ã„ã‚‹ä»•çµ„ã¿ãªã‚“ã§ã™ãŒã€
ä»Šå›ã¯Laravelã§ã‚‚å®Ÿç¾å¯èƒ½ã‹ã¡ã‚‡ã£ã¨è©¦ã—ã¦ã¿ãŸã£ã¦ãŠè©±ã§ã™ã€‚

## å˜ä¸€ãƒ†ãƒ¼ãƒ–ãƒ«ç¶™æ‰¿ï¼ˆSTI = single table inheritanceï¼‰ã¨ã¯

ãã‚‚ãã‚‚ã€å˜ä¸€ãƒ†ãƒ¼ãƒ–ãƒ«ç¶™æ‰¿ãŒä½•ã‹ã£ã¦è©±ãªã‚“ã§ã™ãŒã€AIã•ã‚“ã«èãã¨ã„ã„æ„Ÿã˜ã®ç­”ãˆãŒè¿”ã£ã¦ãã¾ã™ã€‚
ä»Šå›ã¯`Google Bard`ã•ã‚“ã«èã„ã¦ã¿ã‚‹ã¨ã€

:::message
å˜ä¸€ãƒ†ãƒ¼ãƒ–ãƒ«ç¶™æ‰¿ã¨ã¯ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®ç¶™æ‰¿ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«é©ç”¨ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚
è¦ªã‚¯ãƒ©ã‚¹ã¨å­ã‚¯ãƒ©ã‚¹ã®å…±é€šã®å±æ€§ã‚’1ã¤ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¾ã¨ã‚ã‚‹ã“ã¨ã§ã€ã‚³ãƒ¼ãƒ‰ã®é‡è¤‡ã‚’æ’é™¤ã—ã€ä¿å®ˆæ€§ã‚’é«˜ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
:::

å…±é€šã®å±æ€§ã£ã¦ã‚„ã¤ã¯Ruby on Railsã§ã¯ã€`type`ã¨ã„ã†å±æ€§ã‚’ã‚¯ãƒ©ã‚¹ã®è­˜åˆ¥ã«ä½¿ç”¨ã—ã¦ã„ã‚‹[^1]ã®ã§
ä»Šå›ã‚‚`type`ã‚’ä½¿ã£ã¦ã‚„ã£ã¦ã„ã“ã†ã¨æ€ã„ã¾ã™ã€‚

[^1]:https://railsguides.jp/association_basics.html#%E5%8D%98%E4%B8%80%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E7%B6%99%E6%89%BF-%EF%BC%88sti%EF%BC%89

## ç’°å¢ƒ

- PHP 8.2.12
- Laravel 10.33.0

## äº‹å‰æº–å‚™

ä»Šå›ã¯`members`ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä¾‹ã«ã‚„ã£ã¦ã„ã“ã†ã¨æ€ã†ã®ã§ã€Artisanã‚³ãƒãƒ³ãƒ‰ã§è¦ªã‚¯ãƒ©ã‚¹ã«ãªã‚‹Eloquentãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹ã‚’ã‚µã‚¯ãƒƒã¨ä½œã£ã¦ãŠãã¾ã™ã€‚

`-f`ã§ãƒ•ã‚¡ã‚¯ãƒˆãƒªã‚¯ãƒ©ã‚¹ã€`-m`ã§ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ä¸€ç·’ã«ä½œã‚Šã¾ã™ã€‚

```
% php artisan make:model Member -f -m

   INFO  Model [app/Models/Member.php] created successfully.  

   INFO  Factory [database/factories/MemberFactory.php] created successfully.  
   INFO  Migration [database/migrations/2023_11_26_051552_create_members_table.php] created successfully.
```

ã‚³ãƒãƒ³ãƒ‰ã§ä½œã£ãŸã‚ã¨ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã¯ç·¨é›†ã—ã¾ã™ã€‚

```php:database/migrations/2023_11_26_051552_create_members_table.php
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    /**
     * Run the migrations.
     */
    public function up(): void
    {
        Schema::create('members', function (Blueprint $table) {
            $table->id();
            $table->string('name'); // è¿½åŠ 
            $table->string('type'); // è¿½åŠ  å…±é€šã®å±æ€§
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     */
    public function down(): void
    {
        Schema::dropIfExists('members');
    }
};
```

ç·¨é›†å¾Œã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã¯å®Ÿè¡Œã—ã¦ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œã£ã¦ãŠãã¾ã™ã€‚

```
% php artisan migrate
```

ã„ã¾ã®æ™‚ç‚¹ã§ã¯Eloquentãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹ã€ãƒ•ã‚¡ã‚¯ãƒˆãƒªã‚¯ãƒ©ã‚¹ã¯ã¨ãã«å¤‰æ›´ã‚’å…¥ã‚Œã‚‹å¿…è¦ã¯ãªã„ã®ã§ãã®ã¾ã¾ã§ã™ã€‚

## å®Ÿè£…

ã“ã“ã‹ã‚‰ãŒæœ¬é¡Œã§ã™ã€‚

ã•ãã»ã©ä½œæˆã—ãŸã‚¯ãƒ©ã‚¹ã«å¯¾ã—ã¦è‰²ã€…å¤‰æ›´ã‚’å…¥ã‚Œã¦ã„ã“ã†ã¨æ€ã„ã¾ã™ã€‚

### è¦ªã‚¯ãƒ©ã‚¹

è¦ªã‚¯ãƒ©ã‚¹ã«ãªã‚‹`Member`ã‚¯ãƒ©ã‚¹ã«å¯¾ã—ã¦ä¿®æ­£ã‚’å…¥ã‚Œã¦ãŠãã¾ã™ã€‚

ã¾ãšã¯ã€Eloquentãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹ã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ãŸéš›ã¯`Illuminate\Database\Eloquent\Model`ã‚¯ãƒ©ã‚¹ã«å®šç¾©ã—ã¦ã„ã‚‹**newFromBuilder**ãƒ¡ã‚½ãƒƒãƒ‰ã‚’çµŒç”±ã™ã‚‹ã®ã§ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ã¦ã€ä¸€éƒ¨å‡¦ç†ã‚’æ›¸ãæ›ãˆã¾ã™ã€‚

```php:app/Models/Member.php
    /**
     * Create a new model instance that is existing.
     *
     * @param  array  $attributes
     * @param  string|null  $connection
     * @return static
     */
    public function newFromBuilder($attributes = [], $connection = null)
    {
        $attributes = (array) $attributes;
        $type = $attributes['type'];
        $class = $this->getSingleTableClassMap();

        // typeã«ç´ã¥ãã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆã™ã‚‹
        if ($class[$type]) {
            $model = (new $class[$type]())->newInstance([], true);
            $model->setRawAttributes((array) $attributes, true);
            $model->setConnection($connection ?: $this->getConnectionName());
            $model->fireModelEvent('retrieved', false);
            return $model;
        }
        // ç´ã¥ãã‚¯ãƒ©ã‚¹ãŒãªã„æ™‚ã¯å…ƒã®å‡¦ç†ã‚’å‹•ã‹ã™
        return parent::newFromBuilder($attributes, $connection);
    }
```

ã•ã‚‰ã«`type`ã¨ã‚¯ãƒ©ã‚¹ã®ç´ä»˜ã‘ã¯**getSingleTableClassMap**ãƒ¡ã‚½ãƒƒãƒ‰ã«å®Ÿè£…ã—ã¾ã™ã€‚

```php:app/Models/Member.php
    /**
     * @return array<string, string>
     */
    private function getSingleTableClassMap(): array
    {   
        // keyãŒtypeã«ç™»éŒ²ã—ã¦ã„ã‚‹å†…å®¹ã€valueãŒå­ã‚¯ãƒ©ã‚¹ã®åå‰ã®é…åˆ—ã‚’è¿”ã™
        return [
            'Gold' => GoldMember::class,
            'Silver' => SilverMember::class,
            'Bronze' => BronzeMember::class,
            'Normal' => NormalMember::class,
        ];
    }
```

ã“ã‚Œã§ã€`Member::find(1)`ãªã©ã§å–å¾—ã—ãŸéš›ã«`type`ã«ç´ã¥ãå­ã‚¯ãƒ©ã‚¹ãŒä½œæˆã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã¯ãšã§ã™ã€‚

### å­ã‚¯ãƒ©ã‚¹

ç¶šã„ã¦ã¯å…ˆã»ã©ç™»å ´ã—ãŸå­ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚

```php:app/Models/GoldMember.php
<?php

namespace App\Models;

class GoldMember extends Member
{
}
```

è¦ªã«ãªã‚‹`Member`ã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã™ã‚‹ã ã‘ã§çµ‚ã‚ã‚Šã ã£ãŸã‚Šã—ã¾ã™ã€‚
ãŸã ã€ã“ã‚Œã ã‘ã§ã¯`type`ãŒ**Goldã ã‘**ã®Memberã‚’å–å¾—ãŸã‚ã«ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«whereãƒ¡ã‚½ãƒƒãƒ‰ã§æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```php
use App\Models\Member;

Member::query()->where('type', 'Gold')->get();
```

**Gold**ã§çµã‚‹ãªã‚‰`type`ã«ç´ã¥ãå­ã‚¯ãƒ©ã‚¹å´ã§æ¤œç´¢ã™ã‚‹ã ã‘ã«ã—ãŸã„ã®ã§ã€Laravelã®æ©Ÿèƒ½ã§ã‚ã‚Œã‚‹ã‚°ãƒ«ãƒ¼ãƒãƒ«ã‚¹ã‚³ãƒ¼ãƒ—[^2]ã‚’ä½¿ãˆã°è§£æ±ºã—ãã†ã§ã™ã€‚

[^2]:https://laravel.com/docs/10.x/eloquent#global-scopes

ã•ãã»ã©ä½œã£ãŸ`GoldMember`ã‚¯ãƒ©ã‚¹ã«`booted`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ã¦`addGlobalScope`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦ç™»éŒ²ã—ã¾ã™ã€‚

```php:app/Models/GoldMember.php

use Illuminate\Database\Eloquent\Builder;

    /**
     * Perform any actions required after the model boots.
     *
     * @return void
     */
    protected static function booted()
    {
        parent::booted();

        static::addGlobalScope('gold', function (Builder $builder) {
            $builder->where('type', 'Gold');
        });
    }
```

ä¸Šè¨˜ã®ã‚ˆã†ãªå®Ÿè£…ã‚’ã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ãªã‚¯ã‚¨ãƒªãŒæµã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```
% php artisan tinker
> use App\Models\GoldMember;
> GoldMember::query()->toRawSql();
= "select * from `gold_members` where `type` = 'Gold'"
```

whereãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã‚ãªã„ã§ã‚‚æ¡ä»¶ãŒä»˜ãã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
ãŒã€ã„ã¾ã®çŠ¶æ…‹ã§ã¯å­˜åœ¨ã—ãªã„ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¦‹ã¦ã„ã‚‹ã®ã§å®Ÿéš›ã«å®Ÿè¡Œã™ã‚‹ã¨ãƒ†ãƒ¼ãƒ–ãƒ«ãŒãªã„ã£ã¦ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚
ã“ã‚Œã¯`$table`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒæœªæŒ‡å®šã®å ´åˆã¯ã‚¯ãƒ©ã‚¹åã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’ä»˜ã‘ã¦ãã‚Œã‚‹ä»•çµ„ã¿ãŒå‹•ããŸã‚ã§ã™ã€‚
ã“ã‚Œã¯ã“ã‚Œã§ä¾¿åˆ©ã ã‘ã©ä»Šå›ã¯ä¸è¦ãªä»•çµ„ã¿ãªã®ã§è¦ªã‚¯ãƒ©ã‚¹ã®`Member`ã‚¯ãƒ©ã‚¹ã®æ–¹ã«`$table`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’æŒ‡å®šã—ã¦ãŠãã¾ã™ã€‚
ãã†ã™ã‚Œã°å­ã‚¯ãƒ©ã‚¹å´ã§ã‚‚`members`ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‚ç…§ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```php:app/Models/Member.php
class Member extends Model
{
    use HasFactory;

    /**
     * The table associated with the model.
     *
     * @var string
     */
    protected $table = 'members';
}
```

ã“ã®çŠ¶æ…‹ã§å†åº¦`GoldMember`ã‚¯ãƒ©ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€

```
% php artisan tinker
> use App\Models\GoldMember;
> GoldMember::query()->toRawSql();
= "select * from `members` where `type` = 'Gold'"
```

`members`ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‚ç…§ã—ã¦ãã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

ã“ã‚“ãªæ„Ÿã˜ã§æ®‹ã‚Šã®å­ã‚¯ãƒ©ã‚¹ï¼ˆSilverã€Bronzeã€Normalï¼‰ã‚‚ä½œã£ã¦ãŠãã¾ã™ã€‚

### ãƒ•ã‚¡ã‚¯ãƒˆãƒªã‚¯ãƒ©ã‚¹

ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ã‚µã‚¯ãƒƒã¨ä½œã‚ŠãŸã„ã®ã§ãƒ•ã‚¡ã‚¯ãƒˆãƒªã‚¯ãƒ©ã‚¹ã‚‚å°‘ã€…æ‰‹ã‚’å…¥ã‚Œã¦ãŠãã¾ã™ã€‚
åˆæœŸã¯Normalã€ãã‚Œä»¥å¤–ã®`type`ã¯å°‚ç”¨ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½œæˆã—ã¦ãŠãã¾ã™ã€‚

```php:database/factories/MemberFactory.php
<?php

namespace Database\Factories;

use Illuminate\Database\Eloquent\Factories\Factory;

/**
 * @extends \Illuminate\Database\Eloquent\Factories\Factory<\App\Models\Member>
 */
class MemberFactory extends Factory
{
    /**
     * Define the model's default state.
     *
     * @return array<string, mixed>
     */
    public function definition(): array
    {
        return [
            'name' => fake()->name(),
            'type' => 'Normal', // åˆæœŸå€¤ã¯Normal
        ];
    }

    public function gold(): static
    {
        return $this->state(fn (array $attributes) => [
            'type' => 'Gold',
        ]);
    }

    public function silver(): static
    {
        return $this->state(fn (array $attributes) => [
            'type' => 'Silver',
        ]);
    }

    public function bronze(): static
    {
        return $this->state(fn (array $attributes) => [
            'type' => 'Bronze',
        ]);
    }
}
```

## æˆæœç‰©

ã“ã“ã¾ã§ã®æµã‚Œã§ã§ããŸè¦ªå­ã‚¯ãƒ©ã‚¹ã¯ä¸‹è¨˜ã®é€šã‚Šã§ã™ã€‚

```php:app/Models/Member.php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class Member extends Model
{
    use HasFactory;

    /**
     * The table associated with the model.
     *
     * @var string
     */
    protected $table = 'members';

    /**
     * Create a new model instance that is existing.
     *
     * @param  array  $attributes
     * @param  string|null  $connection
     * @return static
     */
    public function newFromBuilder($attributes = [], $connection = null)
    {
        $attributes = (array) $attributes;
        $type = $attributes['type'];
        $class = $this->getSingleTableClassMap();

        // typeã«ç´ã¥ãã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
        if ($class[$type]) {
            $model = (new $class[$type]())->newInstance([], true);

            $model->setRawAttributes((array) $attributes, true);

            $model->setConnection($connection ?: $this->getConnectionName());

            $model->fireModelEvent('retrieved', false);

            return $model;
        }

        return parent::newFromBuilder($attributes, $connection);
    }

    /**
     * @return array<string, string>
     */
    private function getSingleTableClassMap(): array
    {   
        return [
            'Gold' => GoldMember::class,
            'Silver' => SilverMember::class,
            'Bronze' => BronzeMember::class,
            'Normal' => NormalMember::class,
        ];
    }
}
```

```php:app/Models/GoldMember.php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Builder;

class GoldMember extends Member
{
    /**
     * Perform any actions required after the model boots.
     *
     * @return void
     */
    protected static function booted()
    {
        parent::booted();

        static::addGlobalScope('gold', function (Builder $builder) {
            $builder->where('type', 'Gold');
        });
    }
}

```

```php:app/Models/SilverMember.php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Builder;

class SilverMember extends Member
{
    /**
     * Perform any actions required after the model boots.
     *
     * @return void
     */
    protected static function booted()
    {
        parent::booted();

        static::addGlobalScope('silver', function (Builder $builder) {
            $builder->where('type', 'Silver');
        });
    }
}

```

```php:app/Models/BronzeMember.php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Builder;

class BronzeMember extends Member
{
    /**
     * Perform any actions required after the model boots.
     *
     * @return void
     */
    protected static function booted()
    {
        parent::booted();

        static::addGlobalScope('bronze', function (Builder $builder) {
            $builder->where('type', 'Bronze');
        });
    }
}

```

```php:app/Models/NormalMember.php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Builder;

class NormalMember extends Member
{
    /**
     * Perform any actions required after the model boots.
     *
     * @return void
     */
    protected static function booted()
    {
        parent::booted();

        static::addGlobalScope('normal', function (Builder $builder) {
            $builder->where('type', 'Normal');
        });
    }
}

```

## å‹•ä½œç¢ºèª

ä½œã£ãŸã‚‚ã®ã‚’å‹•ã‹ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
å‹•ä½œç¢ºèªã¯`tinker`ã‚’ä½¿ã£ã¦ã„ãã¾ã™ã€‚

```
% php artisan tinker
> use App\Models\Member;
> 
> Member::factory()->create();
= App\Models\Member {#6319
    name: "Louie Barrows V",
    type: "Normal",
    updated_at: "2023-11-26 06:40:32",
    created_at: "2023-11-26 06:40:32",
    id: 1,
  }

> Member::factory()->create();
= App\Models\Member {#6321
    name: "Jaren Beier I",
    type: "Normal",
    updated_at: "2023-11-26 06:40:39",
    created_at: "2023-11-26 06:40:39",
    id: 2,
  }

> Member::factory()->gold()->create();
= App\Models\Member {#6330
    name: "Miss Anais Cruickshank Sr.",
    type: "Gold",
    updated_at: "2023-11-26 06:41:01",
    created_at: "2023-11-26 06:41:01",
    id: 3,
  }

> Member::factory()->silver()->create();
= App\Models\Member {#6290
    name: "Ruthie McLaughlin",
    type: "Silver",
    updated_at: "2023-11-26 06:41:13",
    created_at: "2023-11-26 06:41:13",
    id: 4,
  }

> Member::factory()->bronze()->create();
= App\Models\Member {#6329
    name: "Americo Kihn DDS",
    type: "Bronze",
    updated_at: "2023-11-26 06:41:24",
    created_at: "2023-11-26 06:41:24",
    id: 5,
  }

> 
```

é©å½“ãªãƒ‡ãƒ¼ã‚¿ã‚’ä½œã£ã¦`Member::all()`ã‚’ä½¿ã†ã¨ã€ãã‚Œãã‚Œ`type`ã«ç´ã¥ãå­ã‚¯ãƒ©ã‚¹ã§å–å¾—ã§ãã¾ã—ãŸã­ã€‚

```
> Member::all();
= Illuminate\Database\Eloquent\Collection {#6261
    all: [
      App\Models\NormalMember {#6289
        id: 1,
        name: "Louie Barrows V",
        type: "Normal",
        created_at: "2023-11-26 06:40:32",
        updated_at: "2023-11-26 06:40:32",
      },
      App\Models\NormalMember {#6319
        id: 2,
        name: "Jaren Beier I",
        type: "Normal",
        created_at: "2023-11-26 06:40:39",
        updated_at: "2023-11-26 06:40:39",
      },
      App\Models\GoldMember {#6293
        id: 3,
        name: "Miss Anais Cruickshank Sr.",
        type: "Gold",
        created_at: "2023-11-26 06:41:01",
        updated_at: "2023-11-26 06:41:01",
      },
      App\Models\SilverMember {#6291
        id: 4,
        name: "Ruthie McLaughlin",
        type: "Silver",
        created_at: "2023-11-26 06:41:13",
        updated_at: "2023-11-26 06:41:13",
      },
      App\Models\BronzeMember {#6340
        id: 5,
        name: "Americo Kihn DDS",
        type: "Bronze",
        created_at: "2023-11-26 06:41:24",
        updated_at: "2023-11-26 06:41:24",
      },
    ],
  }

>
```

å­ã‚¯ãƒ©ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ãŸå ´åˆã‚‚å•é¡Œãªãå–å¾—ã§ãã¾ã—ãŸã­ã€‚

```
> use App\Models\NormalMember
> 
> NormalMember::all()
= Illuminate\Database\Eloquent\Collection {#6330
    all: [
      App\Models\NormalMember {#6321
        id: 1,
        name: "Louie Barrows V",
        type: "Normal",
        created_at: "2023-11-26 06:40:32",
        updated_at: "2023-11-26 06:40:32",
      },
      App\Models\NormalMember {#6254
        id: 2,
        name: "Jaren Beier I",
        type: "Normal",
        created_at: "2023-11-26 06:40:39",
        updated_at: "2023-11-26 06:40:39",
      },
    ],
  }

> 
```

## ã¾ã¨ã‚

åŒã˜ã‚ˆã†ãªæ§‹é€ ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ãŸãã•ã‚“ä½œã‚‹ã‚ˆã‚Šã¯ã€1ãƒ†ãƒ¼ãƒ–ãƒ«ã§é–¢ä¿‚ã§ãã‚‹æ–¹ãŒã™ã£ãã‚Šã™ã‚‹ã‹ã‚‰å€‹äººçš„ã«ã¯å¥½ããªä»•çµ„ã¿ã§ã¯ã‚ã‚‹ã€‚
ãŒã€ã‚¯ãƒ©ã‚¹ã®è¦ªå­é–¢ä¿‚ã§è¡¨ç¾ã—ãŸã“ã¨ãŒå˜ä¸€ãƒ†ãƒ¼ãƒ–ãƒ«ç¶™æ‰¿ãªã®ã‹ã¯ã‚ˆãã‚ã‹ã£ã¦ã„ãªã„ã§ã™ã€‚

å­ã‚¯ãƒ©ã‚¹ã‚’ãŸãã•ã‚“ä½œã‚‹ã“ã¨ã§è¤‡é›‘åŒ–ã™ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã—ã€`type`ã”ã¨ã«åˆ†å²ã‚’æ›¸ãæ–¹ãŒä½¿ã„ã‚„ã™ã„ã‹ã‚‚ã—ã‚Œãªã„
ãªã®ã§ã€ã“ã®ã‚„ã‚Šæ–¹ã‚’ä½¿ã„ã‚„ã™ã„è¦æ¨¡ãªã©ã®è¦‹æ¥µã‚ãŒå¤§äº‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚

## å‚è€ƒè¨˜äº‹

https://bliki-ja.github.io/pofeaa/SingleTableInheritance

https://qiita.com/yebihara/items/9ecb838893ad99be0561

https://qiita.com/acro5piano/items/95ad47acd17f8a5a5b4c

https://qiita.com/grohiro/items/e78bd0e0ba79be4c29dc